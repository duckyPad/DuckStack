REM_BLOCK
    COMPILER TEST SCRIPT
    Focus: Function Calls, Recursion, Control Flow, Scope
END_REM

// 1. Initialize Persistent Global Variable and Standard Global
// _GV0 is a non-volatile global variable
_GV0 = 100
VAR global_acc = 5
VAR unused_global = 9999 // Test: Should never affect output
asdfasdf
// 2. Setup Reserved Variable
// Test write access to reserved vars
_UNSIGNED_MATH = 0  cfgdfg

// ---------------------------------------------------------
// FUNCTION: math_op
// Tests: Return values, Unused arguments, Unused locals
// ---------------------------------------------------------
FUNCTION math_op(val, unused_arg)
    VAR local_res = 0
    VAR unused_local = 777 // Test: Should not pollute stack
    
    local_res = val * 2
    
    // Test: Return value placement on stack
    RETURN local_res 
END_FUNCTION

// ---------------------------------------------------------
// FUNCTION: flow_check
// Tests: WHILE, IF/ELSE, LBREAK, Global access inside function
// ---------------------------------------------------------
FUNCTION flow_check(limit)
    VAR i = 0
    
    // Loop from 0 up to limit
    WHILE i < limit
        
        // If i is 2, add 50 to persistent global
        IF i == 2 THEN
            _GV0 = _GV0 + 50
        ELSE
            // Otherwise add 1
            _GV0 = _GV0 + 1
        END_IF
        
        // Test: Early exit from loop
        IF i == 4 THEN
             LBREAK
        END_IF

        i = i + 1
    END_WHILE
    
    RETURN
END_FUNCTION

// ---------------------------------------------------------
// MAIN EXECUTION FLOW
// ---------------------------------------------------------

// Step A: Simple Function Call
// global_acc (5) * 2 = 10. 
// Second arg (123) is unused.
global_acc = math_op(global_acc, 123) 

// Step B: Control Flow Test
// We pass 10, but loop breaks at 4.
flow_check(10)

// Step C: Verify Results
STRINGLN Result GV0: $_GV0
STRINGLN Result Global: $global_acc
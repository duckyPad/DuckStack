VAR g_counter = 0
VAR g_result = 0
VAR g_shadow_me = 9999
VAR g_flags = 0
FUNCTION math_calc(a, b)
    VAR local_res = 0
    local_res = (a * 2) + (b / 2) - (a % 3)
    VAR g_shadow_me = 1 
    local_res = local_res + g_shadow_me
    RETURN local_res
END_FUNCTION
FUNCTION factorial(n)
    IF n <= 1 THEN
        RETURN 1
    END_IF
    VAR temp = 0
    temp = factorial(n - 1)
    RETURN n * temp
END_FUNCTION
STRINGLN Starting System Test...
STRINGLN Checking Math...
g_result = math_calc(10, 20)
IF g_result == 30 THEN
    STRINGLN [PASS] Math & Scoping
ELSE
    STRINGLN [FAIL] Math & Scoping: Got $g_result
END_IF
IF g_shadow_me == 9999 THEN
    STRINGLN [PASS] Global Shadowing Integrity
ELSE
    STRINGLN [FAIL] Global Shadowing: Var clobbered!
END_IF
g_result = factorial(5) 
STRINGLN Factorial of 5 is: $g_result
VAR bit_val = 1
bit_val = bit_val << 4
bit_val = bit_val | 1
bit_val = bit_val & 240
IF bit_val == 16  and  g_shadow_me > 0 THEN
    STRINGLN [PASS] Bitwise Logic
END_IF
STRINGLN Starting Loop Test...
VAR i = 0
WHILE 1
    i = i + 1
    IF i == 2 THEN
        STRINGLN - Skipping 2
        CONTINUE
    END_IF
    STRINGLN - Count: $i
    IF i >= 4 THEN
        LBREAK
    END_IF
END_WHILE
STRINGLN Testing IO...
MOUSE_MOVE 100 -50
DELAY 100
MOUSE_MOVE -100 50
MOUSE_WHEEL 2
KEYDOWN CTRL
STRING c
KEYUP CTRL
OLED_CLEAR
OLED_RECT 1 0 0 32 32
OLED_CIRCLE 0 5 16 16
OLED_PRINT Done.
OLED_UPDATE
_STR_PRINT_FORMAT = 3
_STR_PRINT_PADDING = 4
STRINGLN Hex check (Should be 001E): $g_result
_UNSIGNED_MATH = 1
VAR neg_check = 0 - 1
STRINGLN Unsigned -1 is: $neg_check
_UNSIGNED_MATH = 0
STRINGLN Test Complete.
STRINGLN Sending Report to admin@example.com...
